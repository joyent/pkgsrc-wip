# $NetBSD$
#
###########################################################
#                  Generated by fbsd2pkg                  #
#              Mon Aug 28 18:05:44 CDT 2017               #
###########################################################

DISTNAME=	plink-${PORTVERSION}
PKGREVISION=	1
CATEGORIES=	biology
MASTER_SITES=	${MASTER_SITE_GITHUB:=chrchang/}
GITHUB_PROJECT=	plink-ng
GITHUB_TAG=	00aaeb53d3edd569c93bd60e7bcd27ced4cd8fdb

MAINTAINER=	bacon@NetBSD.org
#HOMEPAGE=	http://pngu.mgh.harvard.edu/~purcell/plink/
COMMENT=	Whole genome association analysis toolset
LICENSE=	gnu-gpl-v2

BUILDLINK_API_DEPENDS.zlib+=	zlib>=1.2.4

# We need Fortran LDFLAGS to link with Lapack.
USE_LANGUAGES=	c c++ fortran
USE_TOOLS+=	gmake

WRKSRC=		${WRKDIR}/plink-ng-${GITHUB_TAG}/1.9

CFLAGS+=	-DDYNAMIC_ZLIB -I${PREFIX}/include -I.
CXXFLAGS+=	-DDYNAMIC_ZLIB -I${PREFIX}/include
MAKE_FLAGS+=	ZLIB=-lz BLASFLAGS="-L${PREFIX}/lib ${LAPACK_LIBS} ${BLAS_LIBS} -lcblas -lpthread"
INSTALL_TARGET=	install-strip

PORTVERSION=	1.90b4
BLAS_ACCEPTED=	openblas_pthread

INSTALLATION_DIRS=	bin

post-patch:
	${CP} ${WRKSRC}/Makefile.std ${WRKSRC}/Makefile

do-install:
	${INSTALL_PROGRAM} ${WRKSRC}/plink ${DESTDIR}${PREFIX}/bin

.include "../../mk/blas.buildlink3.mk"
.include "../../math/cblas/buildlink3.mk"
.include "../../devel/zlib/buildlink3.mk"
.include "../../mk/pthread.buildlink3.mk"
.include "../../mk/bsd.pkg.mk"
